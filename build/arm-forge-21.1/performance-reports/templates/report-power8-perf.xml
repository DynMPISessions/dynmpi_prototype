<partialReport name="com.allinea.performancereports.perfmetrics"
               xmlns="http://www.allinea.com/2016/AllineaReports">
    <reportMetrics>

        <!-- Override the breakdown section of the 'CPU' summary to direct to 'Perf Metrics'
             instead of the (absent) 'CPU' subsection -->
        <reportMetric id="overview.cpu.percent" breakdownSubsection="perf"/>

        <reportMetric id="com.allinea.metrics.perf.cycles_per_instruction"
                      displayName="Cycles per instruction"
                      tooltip="Derived CPU cycles for each instruction."
                      units=""
                      colour="hsl(108, 64, 24)"
                      source="metric">
                      <sourceDetails metricRef="com.allinea.metrics.perf.cycles_per_instruction"
                                     sampleValue="mean"
                                     aggregation="mean"/>
        </reportMetric>

        <reportMetric id="com.allinea.metrics.perf.floating_point_scalar"
                      displayName="FLOPS scalar lower bound"
                      tooltip="Floating point scalar operations finished."
                      units="/s"
                      colour="hsl(108, 62, 60)"
                      source="metric">
                      <sourceDetails metricRef="com.allinea.metrics.perf.floating_point_scalar"
                                     sampleValue="mean"
                                     aggregation="mean"/>
        </reportMetric>

        <reportMetric id="com.allinea.metrics.perf.cpuVectorFlops"
                      displayName="FLOPS vector lower bound"
                      tooltip="Vector FP instructions completed."
                      units="/s"
                      colour="hsl(108, 62, 60)"
                      source="metric">
                      <sourceDetails metricRef="com.allinea.metrics.perf.cpuVectorFlops"
                                     sampleValue="mean"
                                     aggregation="mean"/>
        </reportMetric>

        <reportMetric id="com.allinea.metrics.perf.cpuMemAccesses"
                      displayName="Memory accesses"
                      tooltip="Processor's data cache reloads from a memory location, including L4 from local, remote, or distant, due to a demand load."
                      units="/s"
                      colour="hsl(108, 64, 38)"
                      source="metric">
                      <sourceDetails metricRef="com.allinea.metrics.perf.cpuMemAccesses"
                                     sampleValue="mean"
                                     aggregation="mean"/>
        </reportMetric>
    </reportMetrics>

    <subsections>

        <!-- Remove the 'cpu' section if perf metrics are present -->
        <subsection id="cpu"
                    overwrite="true"
                    maxAdviceStrings="2"
                    requires="com.allinea.metrics.perf.cycles_per_instruction"/>

        <!-- Change the position of the 'perf' subsection to take the place of the
             (absent) 'CPU' subsection -->
        <subsection id="perf"
                    order="-1000"
                    maxAdviceStrings="2"
                    heading="CPU Metrics"
                    colour="hsl(108, 65, 50)"
                    requires="com.allinea.metrics.perf.cycles_per_instruction">
                    <text>Linux perf event metrics:</text>
                    <!-- Show single/OpenMP percentages here rather than in
                         absent 'CPU' subsection. See ALL-6825 for details. -->
                    <entry  reportMetric="cpu.singleCorePercent"
                            order="-120"
                            requires="applicationDetails.isOpenMp" />
                    <entry  reportMetric="cpu.openMpPercent"
                             order="-110"
                             requires="applicationDetails.isOpenMp" />
                    <entry  reportMetric="com.allinea.metrics.perf.cycles_per_instruction"
                            order="-100"
                            maxBarValue="4">
                    </entry>
                    <entry  reportMetric="com.allinea.metrics.perf.floating_point_scalar"
                            group="floating_point_scalar"
                            order="-90">
                    </entry>
                    <entry  reportMetric="com.allinea.metrics.perf.cpuVectorFlops"
                            group="cpuVectorFlops"
                            order="-80">
                    </entry>
                    <entry  reportMetric="com.allinea.metrics.perf.cpuMemAccesses"
                            group="cpuMemAccesses"
                            order="-70">
                    </entry>
            </subsection>

    </subsections>
</partialReport>
